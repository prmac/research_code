run_sm <- function(tree, data, trait, rep=999) {
tree <- drop.tip(tree, tree[["tip.label"]][! tree[["tip.label"]] %in% data[,1])
data <- data[data[,1] %in% tree[["tip.label"]]]
tr4 <- phylo4d(tree, data, label.type="column")
pruned <- as(extractTree(tr4), "phylo")
ldata <- tdata(tr4, "tip")
ldata <- ldata[pruned[["tip.label"]], trait]
result <- sm.test(ldata, pruned, rep=rep)
result
}
run_sm <- function(tree, data, trait, rep=999) {
tree <- drop.tip(tree, tree[["tip.label"]][! tree[["tip.label"]] %in% data[,1]])
data <- data[data[,1] %in% tree[["tip.label"]]]
tr4 <- phylo4d(tree, data, label.type="column")
pruned <- as(extractTree(tr4), "phylo")
ldata <- tdata(tr4, "tip")
ldata <- ldata[pruned[["tip.label"]], trait]
result <- sm.test(ldata, pruned, rep=rep)
result
}
?parsimony
library(ggplot2)
library(ape)
library(geiger)
library(phangorn)
library(phylobase)
library(ade4)
?parsimony
?diag
length(c(1,2,3))
diag(length(c(1,2,3)))
16200/720
